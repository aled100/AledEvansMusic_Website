---
import Base from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

// ðŸ”§ EDIT THIS: add/remove booked dates (ISO format YYYY-MM-DD)
// You can include November dates now as well (e.g. "2025-11-29")
const booked = new Set([
  "2025-12-06",
  "2025-12-12",
  "2025-11-22",
  "2025-12-13",
  "2025-11-15",
  "2025-11-29",
  // "2026-01-01",
]);

// Helpers
const mondayIndex = (d) => (d.getDay() + 6) % 7; // Monday=0 â€¦ Sunday=6
const iso = (d) => d.toISOString().slice(0, 10);
const inRange = (d, start, end) => d >= start && d <= end;

function monthGrid(year, monthIndex) {
  // Build an array of Date objects + null padding to align Mondays
  const first = new Date(year, monthIndex, 1);
  const daysInMonth = new Date(year, monthIndex + 1, 0).getDate();
  const startPad = mondayIndex(first); // blanks before day 1

  const cells = Array.from({ length: startPad }, () => null);
  for (let day = 1; day <= daysInMonth; day++) {
    cells.push(new Date(year, monthIndex, day));
  }
  // pad trailing so total length is multiple of 7
  while (cells.length % 7 !== 0) cells.push(null);
  return cells;
}

// Coverage range: 10 Nov 2025 â†’ 4 Jan 2026
const rangeStart = new Date(2025, 10, 10); // 10 Nov 2025
const rangeEnd   = new Date(2026, 0, 4);   // 04 Jan 2026

const nov2025 = monthGrid(2025, 10); // November 2025
const dec2025 = monthGrid(2025, 11); // December 2025

// Week spanning 29 Dec 2025 â†’ 4 Jan 2026 (Monâ€“Sun)
const janStart = new Date(2025, 11, 29); // Mon 29 Dec 2025
const janWeek = Array.from({ length: 7 }, (_, i) => {
  const d = new Date(janStart);
  d.setDate(janStart.getDate() + i);
  return d;
});
---

<Base title="Christmas 2025 â€” Aled Evans" description="Festive live music and DJ packages for Christmas parties 2025.">
  <Header />

  <!-- Festive Hero (page-specific) -->
  <section class="relative -mt-20 md:-mt-24 hero">
    <picture>
      <source srcset="/images/hero-christmas-mobile.jpeg" media="(max-width: 768px)" />
      <img
        src="/images/hero-christmas.jpeg"
        alt="Festive crowd enjoying live music"
        class="absolute inset-0 h-full w-full object-cover"
        style="object-position: 50% 40%;"
      />
    </picture>

    <!-- Put overlay behind content -->
    <div class="absolute inset-0 z-0 bg-black/40 md:bg-black/30"></div>

    <!-- Ensure content sits above overlay -->
    <div class="relative z-10 container pt-24 pb-28 md:pt-36 md:pb-40 text-center">
      <!-- ðŸŽ„ Christmas hero logo -->
      <img
        src="/images/logo-christmas.jpeg"
        alt="Aled Evans Christmas logo"
        class="mx-auto mb-6 h-28 w-28 md:h-72 md:w-72 rounded-full ring-2 ring-white/20 shadow-lg"
        loading="lazy"
      />

      <!-- Activate block halo behind the text block -->
      <div class="hero__content inline-block">
        <!-- Frosted plaque that hugs the text + subtle halo on letters -->
        <div class="hero__plaque mx-auto max-w-2xl text-center">
          <h1 class="h1 font-serif tracking-tight text-black text-halo">
            Christmas 2025 Packages
          </h1>
          <p class="lead mt-2 text-black text-halo">
            Live acoustic Christmas classics + a festive curated playlist to keep the party going.
          </p>
        </div>
      </div>

      <div class="mt-6">
        <a href="/contact" class="btn" aria-label="Enquire about Christmas 2025 packages">Enquire Now</a>
      </div>
    </div>
  </section>

  <!-- Page content -->
  <main class="section">
    <div class="container space-y-8">
      <section>
        <h2 class="h3 font-serif mb-2">ðŸŽ„ Acoustic Christmas Classics</h2>
        <p>45 minutes of Christmas sing-along favourites â€“ all the classics your guests will love to join in with.</p>
      </section>

      <section>
        <h2 class="h3 font-serif mb-2">ðŸŽ‰ Party Time</h2>
        <p>45 minutes of upbeat acoustic party songs â€“ guaranteed to get the energy up and people singing/dancing.</p>
      </section>

      <section>
        <h2 class="h3 font-serif mb-2">ðŸŽ§ Keep the Party Going</h2>
        <p>Curated Christmas playlist during the breaks, so the festive atmosphere never dips.</p>
      </section>

      <!-- âœ… Christmas Songlist -->
      <section>
        <h2 class="h3 font-serif mb-4">âœ¨ Hereâ€™s an example of the acoustic songs Iâ€™ll be playing</h2>
        <ul class="list-disc list-inside space-y-1">
          <li>Merry Xmas Everybody â€” Slade</li>
          <li>Last Christmas â€” Wham!</li>
          <li>Merry Christmas Everyone â€” Shakin' Stevens</li>
          <li>Fairytale of New York â€” The Pogues ft. Kirsty MacColl</li>
          <li>All I Want for Christmas â€” Mariah Carey</li>
          <li>Do They Know Itâ€™s Christmas? â€” Band Aid</li>
          <li>Santa Claus is Cominâ€™ to Town â€” Bruce Springsteen</li>
        </ul>
      </section>

      <!-- âœ… Availability Calendar -->
      <section>
        <h2 class="h3 font-serif mb-6">Availability â€” 10 Nov 2025 to 4 Jan 2026</h2>

        <!-- Legend -->
        <div class="flex items-center gap-4 mb-4 text-sm">
          <div class="flex items-center gap-2">
            <span class="inline-block h-3 w-3 rounded bg-emerald-200 ring-1 ring-emerald-400/40"></span>
            <span>Available</span>
          </div>
          <div class="flex items-center gap-2">
            <span class="inline-block h-3 w-3 rounded bg-rose-200 ring-1 ring-rose-400/40"></span>
            <span>Booked</span>
          </div>
          <div class="flex items-center gap-2">
            <span class="inline-block h-3 w-3 rounded bg-transparent ring-1 ring-coal/10"></span>
            <span>Out of range</span>
          </div>
        </div>

        <div class="grid gap-8 md:grid-cols-2">
          <!-- November 2025 -->
          <div>
            <div class="flex items-baseline justify-between mb-3">
              <h3 class="font-serif text-xl">November 2025</h3>
              <div class="small text-coal/70">Mon â€” Sun</div>
            </div>
            <div class="grid grid-cols-7 gap-1 text-center small text-coal/70 mb-1">
              <div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div><div>Sun</div>
            </div>
            <div class="grid grid-cols-7 gap-1">
              {nov2025.map((d) => {
                if (!d) return <div class="h-12 rounded bg-transparent"></div>;
                const dayISO = iso(d);
                const inWindow = inRange(d, rangeStart, rangeEnd);
                const isBooked = inWindow && booked.has(dayISO);

                // Out-of-range days (1stâ€“9th Nov) shown muted
                if (!inWindow) {
                  return (
                    <div class="relative h-12 rounded bg-transparent ring-1 ring-coal/10 text-coal/40">
                      <div class="absolute top-1 left-1 text-xs font-semibold">{d.getDate()}</div>
                    </div>
                  );
                }

                return (
                  <div class={`relative h-12 rounded ring-1 ${isBooked
                    ? 'bg-rose-200 ring-rose-400/40 text-coal'
                    : 'bg-emerald-200 ring-emerald-400/40 text-coal'}`}>
                    <div class="absolute top-1 left-1 text-xs font-semibold">{d.getDate()}</div>
                    {isBooked && (
                      <svg viewBox="0 0 24 24" class="absolute inset-0 m-auto h-6 w-6 opacity-50">
                        <path d="M5 5L19 19M19 5L5 19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    )}
                  </div>
                );
              })}
            </div>
            <p class="small mt-2 text-coal/70">Covers 10â€“30 Nov 2025.</p>
          </div>

          <!-- December 2025 -->
          <div>
            <div class="flex items-baseline justify-between mb-3">
              <h3 class="font-serif text-xl">December 2025</h3>
              <div class="small text-coal/70">Mon â€” Sun</div>
            </div>
            <div class="grid grid-cols-7 gap-1 text-center small text-coal/70 mb-1">
              <div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div><div>Sun</div>
            </div>
            <div class="grid grid-cols-7 gap-1">
              {dec2025.map((d) => {
                if (!d) return <div class="h-12 rounded bg-transparent"></div>;
                const dayISO = iso(d);
                const isBooked = booked.has(dayISO);
                return (
                  <div class={`relative h-12 rounded ring-1 ${isBooked
                      ? 'bg-rose-200 ring-rose-400/40 text-coal'
                      : 'bg-emerald-200 ring-emerald-400/40 text-coal'}`}>
                    <div class="absolute top-1 left-1 text-xs font-semibold">{d.getDate()}</div>
                    {isBooked && (
                      <svg viewBox="0 0 24 24" class="absolute inset-0 m-auto h-6 w-6 opacity-50">
                        <path d="M5 5L19 19M19 5L5 19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    )}
                  </div>
                );
              })}
            </div>
          </div>

          <!-- First week of Jan 2026 (now same width as months) -->
          <div>
            <div class="flex items-baseline justify-between mb-3">
              <h3 class="font-serif text-xl">Week of 29 Dec â†’ 4 Jan</h3>
              <div class="small text-coal/70">Mon â€” Sun</div>
            </div>
            <div class="grid grid-cols-7 gap-1 text-center small text-coal/70 mb-1">
              <div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div><div>Sun</div>
            </div>
            <div class="grid grid-cols-7 gap-1">
              {janWeek.map((d) => {
                const dayISO = iso(d);
                const inWindow = inRange(d, rangeStart, rangeEnd);
                const isBooked = inWindow && booked.has(dayISO);

                if (!inWindow) {
                  return (
                    <div class="relative h-12 rounded bg-transparent ring-1 ring-coal/10 text-coal/40">
                      <div class="absolute top-1 left-1 text-xs font-semibold">{d.getDate()}</div>
                    </div>
                  );
                }

                return (
                  <div class={`relative h-12 rounded ring-1 ${isBooked
                      ? 'bg-rose-200 ring-rose-400/40 text-coal'
                      : 'bg-emerald-200 ring-emerald-400/40 text-coal'}`}>
                    <div class="absolute top-1 left-1 text-xs font-semibold">
                      {d.getDate()}{d.getMonth() === 0 ? <span class="small"> Jan</span> : null}
                    </div>
                    {isBooked && (
                      <svg viewBox="0 0 24 24" class="absolute inset-0 m-auto h-6 w-6 opacity-50">
                        <path d="M5 5L19 19M19 5L5 19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    )}
                  </div>
                );
              })}
            </div>
            <p class="small mt-2 text-coal/70">Covers 29â€“31 Dec 2025 and 1â€“4 Jan 2026.</p>
          </div>
        </div>
      </section>

      <div>
        <a href="/contact" class="btn">Check My Date</a>
      </div>
    </div>
  </main>

  <Footer />
</Base>
